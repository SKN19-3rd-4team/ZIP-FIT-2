# API ν…μ¤νΈ κ°€μ΄λ“

> **μ‹¤μ  λ°μ΄ν„°λ΅ API ν…μ¤νΈ λ° μ‘λ‹µ ν•μ‹ ν™•μΈ**

---

## β… ν„μ¬ μƒνƒ

- **ν¬λ΅¤λ§ μ™„λ£**: β…
- **λ°μ΄ν„° ν™•μΈ**: β… (2κ° κ³µκ³  λ°μ΄ν„° μ €μ¥λ¨)
- **λ‹¤μ λ‹¨κ³„**: API ν…μ¤νΈ

---

## π“‹ API ν…μ¤νΈ μμ„

### 1λ‹¨κ³„: Django μ„λ²„ μ‹¤ν–‰

**ν„°λ―Έλ„μ—μ„ μ‹¤ν–‰**:
```bash
cd zf_django
conda activate zipfit_env
python manage.py runserver
```

**ν™•μΈ μ‚¬ν•­**:
- μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‹μ‘λλ”μ§€ ν™•μΈ
- `http://127.0.0.1:8000` μ ‘μ† κ°€λ¥ν•μ§€ ν™•μΈ

---

### 2λ‹¨κ³„: API λ¬Έμ„ μ ‘μ†

**λΈλΌμ°μ €μ—μ„ μ ‘μ†**:
- `http://127.0.0.1:8000/api/docs`

**ν™•μΈ μ‚¬ν•­**:
- Swagger UIκ°€ μ •μƒμ μΌλ΅ ν‘μ‹λλ”μ§€ ν™•μΈ
- API μ—”λ“ν¬μΈνΈ λ©λ΅ ν™•μΈ

---

### 3λ‹¨κ³„: API ν…μ¤νΈ (μ°μ„ μμ„ μ)

#### β… 1. GET /api/annc_summary (κ°€μ¥ κ°„λ‹¨)

**ν…μ¤νΈ λ°©λ²•**:
1. `/api/docs`μ—μ„ `GET /api/annc_summary` μ°ΎκΈ°
2. "Try it out" ν΄λ¦­
3. "Execute" ν΄λ¦­
4. μ‘λ‹µ ν™•μΈ

**μμƒ μ‘λ‹µ**:
```json
{
    "message": "μ„±κ³µμ μΌλ΅ κ³µκ³  μ”μ•½ μ •λ³΄λ¥Ό μ΅°νν–μµλ‹λ‹¤.",
    "status": "success",
    "data": {
        "cnt_total": 2,
        "cnt_lease": 2,
        "cnt_sale": 0,
        "cnt_etc": 0
    }
}
```

**ν™•μΈ μ‚¬ν•­**:
- [ ] `cnt_total`μ΄ 2μΈμ§€ ν™•μΈ
- [ ] `cnt_lease`κ°€ 2μΈμ§€ ν™•μΈ (μ„λ€ κ³µκ³  2κ°)
- [ ] μ‘λ‹µ ν•μ‹μ΄ μμƒκ³Ό μΌμΉν•λ”μ§€ ν™•μΈ

---

#### β… 2. GET /api/anncs (κ³µκ³  λ©λ΅ μ΅°ν)

**ν…μ¤νΈ λ°©λ²•**:
1. `/api/docs`μ—μ„ `GET /api/anncs` μ°ΎκΈ°
2. "Try it out" ν΄λ¦­
3. νλΌλ―Έν„° μ…λ ¥:
   - `annc_status`: "μ „μ²΄"
   - `annc_type`: "μ „μ²΄"
   - `items_per_page`: 10
   - `current_page`: 1
4. "Execute" ν΄λ¦­
5. μ‘λ‹µ ν™•μΈ

**μμƒ μ‘λ‹µ**:
```json
{
    "message": "μ„±κ³µμ μΌλ΅ κ³µκ³  λ©λ΅μ„ μ΅°νν–μµλ‹λ‹¤.",
    "status": "success",
    "data": {
        "page_info": {
            "total_count": 2,
            "current_page": 1,
            "items_per_page": 10,
            "total_pages": 1
        },
        "items": [
            {
                "annc_id": 1,
                "annc_title": "...",
                "annc_url": "...",
                "created_dttm": "...",
                "annc_status": "..."
            },
            ...
        ]
    }
}
```

**ν™•μΈ μ‚¬ν•­**:
- [ ] `total_count`κ°€ 2μΈμ§€ ν™•μΈ
- [ ] `items` λ°°μ—΄μ— 2κ°μ κ³µκ³ κ°€ μλ”μ§€ ν™•μΈ
- [ ] κ° κ³µκ³ μ ν•„λ“κ°€ μ¬λ°”λ¥Έμ§€ ν™•μΈ (`annc_id`, `annc_title`, `annc_url`, `created_dttm`, `annc_status`)

---

#### β… 3. GET /api/chathistories (μ±„ν… νμ¤ν† λ¦¬ λ©λ΅)

**ν…μ¤νΈ λ°©λ²•**:
1. `/api/docs`μ—μ„ `GET /api/chathistories` μ°ΎκΈ°
2. "Try it out" ν΄λ¦­
3. νλΌλ―Έν„° μ…λ ¥:
   - `user_key`: "ν…μ¤νΈν‚¤" (μ„μμ κ°’)
4. "Execute" ν΄λ¦­
5. μ‘λ‹µ ν™•μΈ

**μμƒ μ‘λ‹µ** (λ°μ΄ν„° μ—†μ„ μ μμ):
```json
{
    "message": "μ„±κ³µμ μΌλ΅ μ±„ν… νμ¤ν† λ¦¬ λ©λ΅μ„ μ΅°νν–μµλ‹λ‹¤.",
    "status": "success",
    "data": []
}
```

**ν™•μΈ μ‚¬ν•­**:
- [ ] λΉ λ°°μ—΄μ΄ λ°ν™λλ”μ§€ ν™•μΈ (μ •μƒ)
- [ ] μ‘λ‹µ ν•μ‹μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ

---

#### β οΈ 4. POST /api/chat (μ±„ν… λ©”μ‹μ§€ μ „μ†΅)

**ν…μ¤νΈ λ°©λ²•**:
1. `/api/docs`μ—μ„ `POST /api/chat` μ°ΎκΈ°
2. "Try it out" ν΄λ¦­
3. Request body μ…λ ¥:
   ```json
   {
       "user_key": "ν…μ¤νΈν‚¤",
       "session_key": "test-session-001",
       "user_message": "ν…μ¤νΈ λ©”μ‹μ§€"
   }
   ```
4. "Execute" ν΄λ¦­
5. μ‘λ‹µ ν™•μΈ

**μ£Όμ μ‚¬ν•­**:
- μ‹¤μ  LLM APIκ°€ μ—°κ²°λμ–΄ μμ§€ μ•μΌλ©΄ λ”λ―Έ μ‘λ‹µμ΄ μ¬ μ μμ
- API ν‚¤ μ„¤μ •μ΄ ν•„μ”ν•  μ μμ

---

## π“ μ‘λ‹µ ν•μ‹ λ¬Έμ„ν™”

**κ° API ν…μ¤νΈ ν›„ `lab/ohj/apiμ‘λ‹µν•μ‹.md` νμΌμ— κΈ°λ΅**:

### κΈ°λ΅ ν•μ‹:
```markdown
## 1. GET /api/annc_summary

**μ‹¤μ  μ‘λ‹µ**:
```json
{
    "message": "...",
    "status": "...",
    "data": {
        "cnt_total": 2,
        ...
    }
}
```

**ν™•μΈ μ‚¬ν•­**:
- β… cnt_total: 2 (μμƒκ³Ό μΌμΉ)
- β… μ‘λ‹µ ν•μ‹ μ •μƒ
```

---

## π” ν™•μΈν•΄μ•Ό ν•  μ£Όμ” μ‚¬ν•­

### 1. λ°μ΄ν„° μΌμΉ μ—¬λ¶€
- API μ‘λ‹µμ `cnt_total`μ΄ μ‹¤μ  DBμ κ³µκ³  κ°μμ™€ μΌμΉν•λ”μ§€
- κ³µκ³  λ©λ΅μ λ°μ΄ν„°κ°€ μ‹¤μ  DB λ°μ΄ν„°μ™€ μΌμΉν•λ”μ§€

### 2. μ‘λ‹µ ν•μ‹
- API λ¬Έμ„μ μ¤ν‚¤λ§μ™€ μ‹¤μ  μ‘λ‹µμ΄ μΌμΉν•λ”μ§€
- ν•„λ“λ…μ΄ μ¬λ°”λ¥Έμ§€ (`annc_id`, `annc_title` λ“±)
- λ‚ μ§ ν•μ‹ ν™•μΈ (`created_dttm`)

### 3. μ—λ¬ μ²λ¦¬
- μλ»λ νλΌλ―Έν„° μ…λ ¥ μ‹ μ—λ¬ μ‘λ‹µ ν•μ‹ ν™•μΈ
- λΉ λ°μ΄ν„° μ²λ¦¬ ν™•μΈ

---

## π’΅ λΉ λ¥Έ ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ

- [ ] Django μ„λ²„ μ‹¤ν–‰
- [ ] `/api/docs` μ ‘μ† ν™•μΈ
- [ ] `GET /api/annc_summary` ν…μ¤νΈ β†’ μ‘λ‹µ ν™•μΈ
- [ ] `GET /api/anncs` ν…μ¤νΈ β†’ μ‘λ‹µ ν™•μΈ
- [ ] `GET /api/chathistories` ν…μ¤νΈ β†’ μ‘λ‹µ ν™•μΈ
- [ ] `POST /api/chat` ν…μ¤νΈ (μ„ νƒμ‚¬ν•­)
- [ ] μ‘λ‹µ ν•μ‹ λ¬Έμ„ν™”

---

## π€ λ‹¤μ λ‹¨κ³„

**API ν…μ¤νΈ μ™„λ£ ν›„**:
1. μ‹¤μ  μ‘λ‹µ ν•μ‹μ— λ§μ¶° ν”„λ΅ νΈμ—”λ“ κ°λ° μ§„ν–‰
2. `main.html` - `/api/annc_summary` μ—°λ™
3. `list.html` - `/api/anncs` μ—°λ™
4. `chat.html` - `/api/chat` μ—°λ™

---

**μ‘μ„±μΌ**: 2025-01-20  
**μƒνƒ**: API ν…μ¤νΈ κ°€μ΄λ“ μ‘μ„± μ™„λ£

