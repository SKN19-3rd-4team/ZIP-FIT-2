# Merge 후 문제 해결 요약

## 해결된 문제

### 1. list 페이지 필터 문제 ✅
**문제**: 필터(전체 기관 | 전체 유형 | 전체 상태)가 동작하지 않음

**원인**: 
- `zf_django/chatbot/views.py`의 `annc_list` 함수에서 `agency` 파라미터를 처리하지 않음
- 빈 값('')과 '전체' 값에 대한 처리 누락

**해결**:
- `annc_list` 함수에 `agency` 파라미터 처리 로직 추가
- URL 패턴 기반 기관 필터링 구현 (LH: lh.or.kr, SH: i-sh.co.kr, GH: gh.or.kr)
- 빈 값('')과 '전체' 값에 대한 조건 추가

**변경 파일**:
- `zf_django/chatbot/views.py`: `annc_list` 함수 수정

### 2. user-info 페이지 초기화 문제 ✅
**문제**: landing 페이지에서 "서비스 시작" 시 이전 사용자 입력 데이터가 남아있음

**원인**: 
- landing 페이지에서 user-info로 이동할 때 `sessionStorage`를 초기화하지 않음

**해결**:
- landing 페이지의 "시작하기" 버튼에 `onclick="sessionStorage.removeItem('userInfo');"` 추가
- URL에 `?reset=1` 파라미터 추가하여 user-info 페이지에서도 초기화 확인

**변경 파일**:
- `zf_django/web/templates/web/landing.html`: "시작하기" 버튼 수정

### 3. 채팅 히스토리 목록 제한 문제 ✅
**문제**: 
- main 페이지에서 mockData의 3개 중 2개만 표시됨
- list 페이지에서도 동일한 문제 발생

**원인**: 
- `main.html`과 `list.html`의 `loadChatHistories` 함수에서 `.slice(0, 2)`로 2개만 표시

**해결**:
- `.slice(0, 2)` 제거하여 모든 채팅 히스토리 표시

**변경 파일**:
- `zf_django/web/templates/web/main.html`: `loadChatHistories` 함수 수정
- `zf_django/web/templates/web/list.html`: `loadChatHistories` 함수 수정

## 확인 사항

### 1. AI 상담 로딩 메시지
- 일반 질문: "답변을 생성하고 있습니다..."
- 공고 카드에서 "AI 상담하기" 클릭: "'[공고 이름]' 문서를 참조 중입니다..."

**확인 필요**: `chat.html`의 `addLoadingMessage` 함수가 올바르게 동작하는지 확인

### 2. list 페이지 기능
- D-day 함수 적용 확인
- 각종 태그 추출 적용 확인
- 정렬 로직 확인 (공고중 > 접수중 > 공고예정 > 마감)
- 홀수 공고 시 카드 배열 위치 확인

## 테스트 체크리스트

- [o] landing 페이지에서 "시작하기" 클릭 시 user-info 페이지가 빈 상태로 표시되는지 확인
- [x] list 페이지에서 필터(기관, 유형, 상태)가 정상 작동하는지 확인
    -> 3개의 필터가 올바르지 않게 작동됨. api 호출 모드시, mock에서는 문제 없음
- [o] main 페이지에서 모든 채팅 히스토리(3개)가 표시되는지 확인
    -> api 문제없음(실제 세션기반), mock 에서 테스트시 문제되었던 부분 해결됨
- [o] list 페이지에서 모든 채팅 히스토리(3개)가 표시되는지 확인
    -> api 문제없음(실제 세션기반), mock 에서 테스트시 문제되었던 부분 해결됨
- [o] chat 페이지에서 모든 채팅 히스토리(3개)가 표시되는지 확인
    -> api 문제없음(실제 세션기반), mock 에서 테스트시 문제되었던 부분 해결됨
- [x] 공고 카드에서 "AI 상담하기" 클릭 시 올바른 로딩 메시지가 표시되는지 확인
    -> 일반 chat, 공고 카드에서 "AI 상담하기" 둘다 api 호출 하는 웹페이지에서는 로딩표시가 없이 결과만 바로 출려되는 것 같음.

## 추가 문제 파악 (api 호출 데이터)

- [정정공고]양주회천 A25BL 영구임대주택 입주자 모집공고
    |공고상태| 공고중|
    |유형| 영구임대|
    |공고일| 2025.11.27|
    |접수기간| 2025.12.15 ~ 2025.12.19|

위 정보가 실제 홈페이지를 들어가면 나오는 정보다.

- 우리 웹페이지에서는 공고 카드에서 아래와 같이 나온다.

    |태그| LH | 영구임대| 공고예정|
    [정정공고]양주회천 A25BL 영구임대주택 입주자 모집공고
    |모집 기간 |2025.12.12 ~ 2025.12.25|


즉, 상태는 '공고중'이어야한다. -> 공고 등록일을 실제 메타데이터 API 에서 호출할 때, 응답받는 데이터에서 올바르게 값을 가져와야할 것 같다.
그래야 태그 정보가 제대로 반영될 것 같음.
그래서 지금 D-day도 없는 것 같음.

