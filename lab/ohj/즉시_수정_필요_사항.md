# 즉시 수정 필요 사항

## 1. 유형 태그 표시 문제 ✅ (수정 완료)

**문제**: 두 공고가 모두 "임대"로 태그가 표시됨

**원인**: 
- `annc_type` 필드를 사용하고 있음 (값: "임대")
- `annc_dtl_type` 필드를 사용해야 함 (값: "영구임대", "행복주택")

**해결**:
- `createAnnouncementCard` 함수에서 `annc_dtl_type` 필드를 우선 사용하도록 수정
- `annc_dtl_type`이 없으면 `annc_type` 사용 (단, "임대", "분양" 같은 일반적인 값 제외)
- 없으면 제목에서 추출

**변경 파일**:
- `zf_django/web/templates/web/list.html`: `createAnnouncementCard` 함수 수정
- `zf_django/chatbot/views.py`: `annc_dtl_type` 필드를 API 응답에 추가

## 2. 접수기간 기반 상태 표시 문제 ⚠️ (확인 필요)

**문제**: 접수기간 내에 있으면 "접수중"으로 표시되어야 하는데 "공고중"으로 표시됨

**현재 상황**:
- 양주시, 동두천시 행복주택: 접수기간 2025.06.19 ~ 2025.12.31
- 현재 날짜가 접수기간 내에 있으므로 "접수중"으로 표시되어야 함
- 하지만 "공고중"으로 표시됨

**원인 분석**:
- `annc_pblsh_dt`가 "게시일"이지 "접수 시작일"이 아닐 수 있음
- 접수 시작일 정보가 별도 필드에 없을 수 있음
- 크롤러 코드 확인 필요: `zf_crawler/src/crawler/lh.py`

**확인 필요**:
1. DB에서 실제 데이터 확인:
   ```sql
   SELECT annc_pblsh_dt, annc_deadline_dt, annc_status
   FROM annc_all
   WHERE annc_title LIKE '%양주시%동두천시%';
   ```

2. 크롤러에서 접수 시작일을 추출하는지 확인
3. 접수 시작일을 저장하는 필드가 있는지 확인

**임시 해결책**:
- `annc_status`가 "공고중"이고 현재 날짜가 `annc_pblsh_dt`와 `annc_deadline_dt` 사이에 있으면 "접수중"으로 표시
- 단, `annc_pblsh_dt`가 접수 시작일인지 확인 필요

## 3. 모집 기간 표시 문제 ⚠️ (확인 필요)

**문제**: 접수기간이 모집 기간으로 표시되어야 함

**현재 상황**:
- `getRecruitmentPeriod` 함수가 `annc_pblsh_dt`와 `annc_deadline_dt`를 사용
- 하지만 `annc_pblsh_dt`가 "게시일"이지 "접수 시작일"이 아닐 수 있음

**확인 필요**:
1. DB에서 실제 데이터 확인
2. 크롤러에서 접수 시작일을 추출하는지 확인
3. 접수 시작일을 저장하는 필드가 있는지 확인

**임시 해결책**:
- 현재는 `annc_pblsh_dt`와 `annc_deadline_dt`를 사용
- 접수 시작일 필드가 별도로 있으면 그 필드 사용

## 4. DB 필드 확인 방법

### Django Shell 사용
```bash
cd zf_django
python manage.py shell
```

```python
from chatbot.models import AnncAll

# 특정 공고 확인
annc = AnncAll.objects.filter(annc_title__icontains='양주시').first()
print(f"annc_pblsh_dt: {annc.annc_pblsh_dt}")
print(f"annc_deadline_dt: {annc.annc_deadline_dt}")
print(f"annc_status: {annc.annc_status}")
print(f"annc_type: {annc.annc_type}")
print(f"annc_dtl_type: {annc.annc_dtl_type}")

# 모든 필드 확인
print(annc.__dict__)
```

### DBeaver 사용
```sql
SELECT 
    annc_title,
    annc_pblsh_dt,
    annc_deadline_dt,
    annc_status,
    annc_type,
    annc_dtl_type
FROM annc_all
WHERE annc_title LIKE '%양주%'
LIMIT 5;
```

## 5. 다음 단계

1. **DB 필드 확인**: 위 방법으로 실제 데이터 확인
2. **크롤러 코드 확인**: 접수 시작일을 추출하는지 확인
3. **필요시 수정**: 접수 시작일 필드가 없으면 추가 또는 로직 수정
4. **상태 로직 수정**: 접수기간 내에 있으면 "접수중"으로 표시하도록 수정

## 6. 참고 문서

- `lab/ohj/DB_필드_확인_가이드.md`: DB 필드 확인 방법 상세 가이드
- `lab/ohj/Git_병합_및_크롤러_업데이트_가이드.md`: Git 병합 및 크롤러 업데이트 가이드

