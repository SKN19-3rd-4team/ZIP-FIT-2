# 팀원 코드 병합 전략 문서

## 목표
- `C:\SKN_19\ZIP-FIT-2-main` (팀원 코드)의 변경사항을 현재 프로젝트에 반영
- 우리가 개발한 `zf_django/web` 부분은 유지
- 충돌 없이 안전하게 병합

---

## 1. 파일별 차이점 분석

### 1.1 `zf_django/chatbot/models.py`
**상태**: ✅ 이미 반영 완료
- `created_dttm` → `created_at` 변경 완료
- `updated_dttm` → `updated_at` 변경 완료
- `db_column` 제거 완료

### 1.2 `zf_django/chatbot/views.py`
**상태**: ✅ 이미 반영 완료
- `annc_list`: 팀원 코드와 동일하게 serializer 사용
- `annc_summary`: 팀원 코드와 동일하게 간단한 구조
- `created_at` 사용 완료

### 1.3 `zf_django/chatbot/serializers.py`
**상태**: ⚠️ 부분 반영 필요
- **팀원 코드**: 필드 5개 (`annc_id`, `annc_title`, `annc_url`, `created_at`, `annc_status`)
- **우리 코드**: 필드 10개 (추가: `annc_type`, `annc_dtl_type`, `annc_region`, `annc_pblsh_dt`, `annc_deadline_dt`)
- **결정**: 프론트엔드에서 추가 필드 필요하므로 우리 코드 유지

### 1.4 `zf_django/chatbot/graph.py`
**상태**: ❌ 반영 필요
- **팀원 코드**: V7 (고급 기능)
  - RDB 필터 + RAG 검색 통합
  - 검색 히스토리 및 비교 기능
  - 웹 검색 연동 (Tavily)
  - 의도 분류: search, select, detail, compare, chat
- **우리 코드**: V5 (간단한 버전)
  - 기본 의도 분류만
  - 의도 분류: new_search, reference_prev, detail_question, general_chat, clarification
- **결정**: 팀원 코드로 교체 (V7이 더 완성도 높음)

### 1.5 `zf_django/chatbot/services.py`
**상태**: ⚠️ 부분 반영 필요
- **팀원 코드**: `Chat`, `ChatMessage` 모델 사용
- **우리 코드**: `ChatHistory` 모델 사용 (구버전)
- **결정**: 팀원 코드로 교체 (최신 모델 구조)

### 1.6 `zf_django/chatbot/views_chat.py`
**상태**: ❌ 반영 필요
- **팀원 코드**: LangGraph 통합 완료, 실제 챗봇 동작
- **우리 코드**: 더미 응답만 있음
- **결정**: 팀원 코드로 교체

### 1.7 `zf_django/chatbot/urls.py`
**상태**: ⚠️ 부분 반영 필요
- **팀원 코드**: 경로에 `api/` prefix 없음
- **우리 코드**: 경로에 `api/` prefix 있음
- **결정**: 우리 코드 유지 (프론트엔드와 호환성)

### 1.8 `zf_django/web/`
**상태**: ✅ 우리 코드 유지 (팀원이 개발하지 않음)
- 모든 파일 유지
- `created_dttm` → `created_at` 변경 완료

### 1.9 `zf_crawler/`
**상태**: ⚠️ 부분 반영 필요
- **팀원 코드**: `table_preprocessor.py` 파일 있음 (테이블 전처리 기능)
- **우리 코드**: `table_preprocessor.py` 파일 없음
- **결정**: 팀원 코드에서 파일 추가 필요

### 1.10 `docs/`
**상태**: ✅ 거의 동일
- API 문서 거의 동일
- 큰 차이 없음

### 1.11 `requirements.txt`
**상태**: ✅ 동일
- 두 프로젝트 모두 동일한 패키지 버전

---

## 2. 병합 전략

### 2.1 우선순위

#### 🔴 즉시 반영 (핵심 기능)
1. `zf_django/chatbot/graph.py` - 팀원 코드로 교체
2. `zf_django/chatbot/services.py` - 팀원 코드로 교체
3. `zf_django/chatbot/views_chat.py` - 팀원 코드로 교체

#### 🟡 부분 반영 (호환성 유지)
1. `zf_django/chatbot/serializers.py` - 우리 코드 유지 (프론트엔드 호환)
2. `zf_django/chatbot/urls.py` - 우리 코드 유지 (프론트엔드 호환)

#### 🟢 확인 후 반영
1. `zf_crawler/src/table_preprocessor.py` - 팀원 코드에서 추가
2. `docs/` - 거의 동일, 큰 변경 없음

### 2.2 병합 순서

1. **백업 생성**
   ```bash
   # 현재 프로젝트 백업
   ```

2. **chatbot 앱 파일 교체**
   - `graph.py` 교체
   - `services.py` 교체
   - `views_chat.py` 교체

3. **호환성 확인**
   - `serializers.py` 확인 (우리 코드 유지)
   - `urls.py` 확인 (우리 코드 유지)
   - `models.py` 확인 (이미 반영 완료)

4. **의존성 확인**
   - `requirements.txt` 비교
   - 새로운 패키지 필요 여부 확인 (예: tavily)

5. **테스트**
   - API 엔드포인트 테스트
   - 챗봇 동작 테스트
   - 프론트엔드 연동 테스트

---

## 3. 주의사항

### 3.1 모델 변경
- `ChatHistory` → `Chat`, `ChatMessage`로 변경됨
- 마이그레이션 필요할 수 있음

### 3.2 의존성 추가
- `tavily` 패키지 (웹 검색용, 선택적)
- 기타 패키지 확인 필요

### 3.3 환경 변수
- `TAVILY_API_KEY` (선택적)
- 기존 환경 변수 유지

### 3.4 프론트엔드 호환성
- `zf_django/web/`은 우리 코드 유지
- API 응답 형식 확인 필요

---

## 4. 체크리스트

- [ ] `zf_django/chatbot/graph.py` 교체
- [ ] `zf_django/chatbot/services.py` 교체
- [ ] `zf_django/chatbot/views_chat.py` 교체
- [ ] `zf_django/chatbot/serializers.py` 확인 (우리 코드 유지)
- [ ] `zf_django/chatbot/urls.py` 확인 (우리 코드 유지)
- [ ] `requirements.txt` 비교 및 업데이트
- [ ] 마이그레이션 확인
- [ ] `zf_crawler/src/table_preprocessor.py` 추가
- [ ] `docs/` 확인 (거의 동일)
- [ ] API 테스트
- [ ] 챗봇 테스트
- [ ] 프론트엔드 연동 테스트

---

## 5. 다음 단계

1. 이 문서 검토 및 승인
2. 백업 생성
3. 파일 교체 시작
4. 테스트 진행
5. 문제 발생 시 롤백

