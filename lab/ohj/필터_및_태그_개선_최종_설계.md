# 필터 및 태그 개선 최종 설계서

## 📋 최종 결정 사항

### 1. 공고 카드 태그 구조
**변경 없음**: 기관태그 | 유형태그(분양|임대) | 상태태그
- **유형태그**: `annc_type` 값 사용 ("임대" 또는 "분양")
- **상태태그**: 공고중 | 접수중 | 마감만 표시 (정정공고중은 태그에 표시하지 않음)

### 2. 필터 구조
**변경**: 전체 유형(분양|임대) | 전체 지역 | 전체 상태
- **유형 필터**: 분양 | 임대 (annc_type 기반, 동적 생성)
- **지역 필터**: DB의 고유 annc_region 값들 (동적 생성, 알파벳 순 정렬)
- **상태 필터**: 공고중 | 접수중 | 마감 | 정정공고중 (공고예정은 숨김)

### 3. 상태 처리 로직
- **우선순위**: 무조건 `annc_status` 필드 값 사용 (DB 값 우선)
- **태그 표시**: 공고중 | 접수중 | 마감만 표시
- **정정공고**: 제목에 [정정공고] 표기, annc_status는 "정정공고중" 등으로 올 수 있음

---

## 🎯 구현 계획

### Phase 1: 필터 변경
1. HTML 구조 변경 (기관 필터 숨김, 지역 필터 추가)
2. 유형 필터: annc_dtl_type → annc_type (분양|임대)
3. 지역 필터: 동적 생성 (annc_region 기반)
4. 상태 필터: 정정공고중 추가, 공고예정 숨김

### Phase 2: 태그 변경
1. 유형태그: annc_dtl_type → annc_type (분양|임대)
2. 상태태그: annc_status 우선 사용, 공고중|접수중|마감만 표시

### Phase 3: API 개선
1. annc_summary에 cnt_new_this_week 추가
2. API 명세 확인 및 업데이트

### Phase 4: 테스트
1. 필터 동작 테스트
2. 태그 표시 테스트
3. 동적 필터 생성 테스트

---

## 📝 상세 구현 내용

### 1. 유형태그 변경 (annc_dtl_type → annc_type)
- 현재: 영구임대주택, 행복주택 등 (annc_dtl_type)
- 변경: 임대, 분양 (annc_type)

### 2. 상태태그 로직
```javascript
function getCurrentStatus(annc) {
    // annc_status 필드 우선 사용 (무조건)
    if (annc.annc_status) {
        // 태그에는 공고중|접수중|마감만 표시
        const displayStatuses = ['공고중', '접수중', '마감'];
        if (displayStatuses.includes(annc.annc_status)) {
            return annc.annc_status;
        }
        // 정정공고중은 "공고중"으로 표시 (태그는 공고중으로)
        if (annc.annc_status === '정정공고중') {
            return '공고중';
        }
    }
    
    // fallback: 날짜 기반 계산 (annc_status가 없을 때만)
    // ...
}
```

### 3. 지역 필터 동적 생성
- API 응답에서 고유한 annc_region 값 추출
- 알파벳 순 정렬
- "전국"은 맨 위에 배치 (선택사항)

---

## ✅ 확인 완료 사항

1. ✅ 공고 카드 태그: 유형태그 유지 (지역태그로 변경하지 않음)
2. ✅ 상태 태그: 공고중|접수중|마감만 표시
3. ✅ 상태 우선순위: annc_status 무조건 우선
4. ✅ 지역 정규화: 현재는 그대로 사용, 추후 전체 데이터 기준으로 결정
5. ✅ 지역 정렬: 알파벳 순 (일반적인 웹/앱 방향성)

